# port: 389,636

Notes
# """#LDAP (Lightweight Directory Access Protocol) is a software protocol for enabling anyone to locate organizations, individuals, and other resources such as files and devices in a network, whether on the public Internet or on a corporate intranet. LDAP is a "lightweight" (smaller amount of code) version of Directory Access Protocol (DAP).

https://book.hacktricks.xyz/pentesting/pentesting-ldap
"""

# Grab LDAP Banner
# desc:Banner Grab
nmap -p 389 --script ldap-search -Pn #{LHOST}

# Base LdapSearch
# desc:LdapSearch
ldapsearch -h #{LHOST} -x

# Attempt to get LDAP Naming Context
# desc:LdapSearch Naming Context Dump
ldapsearch -h #{LHOST} -x -s base namingcontexts

# Need Naming Context to do big dump
# desc:LdapSearch Big Dump
ldapsearch -h #{LHOST} -x -b "#{Naming_Context}"

# Need User
# desc:Hydra Brute Force
hydra -l #{USER} -P #{Big_Passwordlist} #{LHOST} ldap2 -V -f

