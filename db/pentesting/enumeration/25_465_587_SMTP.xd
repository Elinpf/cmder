# port: 25,465,587

Notes
# """#SMTP (Simple Mail Transfer Protocol) is a TCP/IP protocol used in sending and receiving e-mail. However, since it is limited in its ability to queue messages at the receiving end, it is usually used with one of two other protocols, POP3 or IMAP, that let the user save messages in a server mailbox and download them periodically from the server.

https://book.hacktricks.xyz/pentesting/pentesting-smtp
"""

# Grab SMTP Banner
# desc:Banner Grab
nc -vn #{LHOST} 25

# SMTP Vuln Scan With Nmap
# desc:SMTP Vuln Scan
nmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 #{LHOST}

# Enumerate uses with smtp-user-enum
# desc:SMTP User Enum
smtp-user-enum -M VRFY -U #{Big_Userlist} -t #{LHOST}

# Attempt to connect to SMTPS two different ways
# desc:SMTPS Connect
openssl s_client -crlf -connect #{LHOST}:465 &&&& openssl s_client -starttls smtp -crlf -connect #{LHOST}:587

# Find MX servers of an organization
# desc:Find MX Servers
dig +short mx #{Domain_Name}

# Need Nothing
# desc:Hydra Brute Force
hydra -P #{Big_Passwordlist} #{LHOST} smtp -V

