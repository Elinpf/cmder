# port: 80,443

Notes
# """#https://book.hacktricks.xyz/pentesting/pentesting-web
"""

# Nikto and GoBuster
# desc:Quick Web Scan
nikto -host #{Web_Proto}://#{LHOST}:#{Web_Port} &&&& gobuster dir -w #{Small_Dirlist} -u #{Web_Proto}://#{LHOST}:#{Web_Port} && gobuster dir -w #{Big_Dirlist} -u #{Web_Proto}://#{LHOST}:#{Web_Port}

# Basic Site Info via Nikto
# desc:Nikto
nikto -host #{Web_Proto}://#{LHOST}:#{Web_Port}

# General purpose auto scanner
# desc:WhatWeb
whatweb -a 4 #{LHOST}

# Non-Recursive Directory Brute Force
# desc:Directory Brute Force Non-Recursive
gobuster dir -w #{Big_Dirlist} -u #{Web_Proto}://#{LHOST}:#{Web_Port}

# Recursive Directory Brute Force
# desc:Directory Brute Force Recursive
python3 #{Tool_Dir}dirsearch/dirsearch.py -w #{Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u #{Web_Proto}://#{LHOST}:#{Web_Port} -r 10

# Common Gateway Interface Brute Force
# desc:Directory Brute Force CGI
gobuster dir -u #{Web_Proto}://#{LHOST}:#{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

# Tailored Nmap Scan for web Vulnerabilities
# desc:Nmap Web Vuln Scan
nmap -vv --reason -Pn -sV -p #{Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` #{LHOST}

# Drupal Enumeration Notes
# desc:Drupal
#git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration


# WordPress Enumeration with WPScan
# desc:WordPress
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url #{Web_Proto}://#{LHOST}#{1} --enumerate ap,at,cb,dbe && wpscan --url #{Web_Proto}://#{LHOST}#{1} --enumerate u,tt,t,vp --passwords #{Big_Passwordlist} -e


# Need User (admin is default)
# desc:WordPress Hydra Brute Force
hydra -l admin -P #{Big_Passwordlist} #{LHOST} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

