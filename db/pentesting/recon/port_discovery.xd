--- masscan

# Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 #{RHOST}

# desc: HTTP port scan
masscan -p80,443,8000-8100,8443 #{RHOST}

--- NMAP

# Top 20 prots
nmap -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 -T4 #{RHOST}

# desc: HTTP port scan
nmap -p80,443,8000-8100,8443 -T4 #{RHOST}

# make nmap only test the most UDP server probable
# desc: UDP server
nmap -sU -sV --version-intensity 0 -F -n #{RHOST}

# Nmap fast scan for the most 1000tcp ports used
# desc: 1000 TCP
nmap -sV -sC -O -T4 -n -Pn -oA fastscan #{RHOST}

# Nmap fast scan for all the ports
# desc: Fast scan ALL
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan #{RHOST}

# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan #{RHOST}

# desc: search Open
ports=$(nmap -p- --min-rate=1000 -T4 #{RHOST} | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//);nmap -sC -sV -p$ports #{RHOST}