# List shared folders with Null user
# desc: with Null Pass
smbclient -L #{RHOST} 

# Entry folder with Null User and no pass
# desc: Entry folder
smbclient //#{RHOST}/#{folder}

# List shared folders
# If you omit the pwd, it will be prompted. With --pw-nt-hash, the pwd provided is the NT hash
smbclient -U '#{USER}#{[%]PWD}' -L #{[--pw-nt-hash ]ntlm} //#{RHOST} 

# List recursively with smbclient
# desc: Recursively
smbclient -U '#{USER}#{[%]PWD}' #{[--pw-nt-hash ]ntlm} //#{RHOST}/#{folder} -c 'recurse;ls'
@folder.desc(SMB Share Folder)

# List shared folders
# desc: Null user
smbmap -H #{RHOST} #{smbmap_port}

# List shared folders
# Creds
smbmap -u "#{USER}" -p "#{PWD}" -H #{RHOST} #{smbmap_port} 

# List shared folders
# Pass-the-Hash
smbmap -u "#{USER}" -p "#{ntlm}" -H #{RHOST} #{smbmap_port} 

# download files
# desc: 下载smb文件
sudo smbmap -R #{folder} -H #{RHOST} -A #{file} -q 

@smbmap_port.desc(SMB Port)
@smbmap_port.recommend(445 (SSH))
@smbmap_port.recommend(139)
@smbmap_port.if_has(-P %s)

@ntlm.desc(NTLM)

@folder.recommend(C$)
@folder.recommend(D$)
@folder.recommend(ADMIN$)
@folder.recommend(IPC$)
@folder.recommend(PRINT$)
@folder.recommend(SYSVOL$)
@folder.recommend(FAX$)
@folder.recommend(NETLOGON$)