# List shared folders with Null user
smbclient --no-pass -L #{RHOST} 

# List shared folders
# If you omit the pwd, it will be prompted. With --pw-nt-hash, the pwd provided is the NT hash
smbclient -U '#{USER}#{PWD}' -L #{ntlm} //#{RHOST} 
@PWD.if_has(%%s)
@ntlm.if_has(--pw-nt-hash %s)

# List recursively with smbclient
smbclient -U '#{USER}#{PWD}' #{ntlm} //#{RHOST}/#{dir} -c 'recurse;ls'
smbclient -U '#{USER}#{[%]PWD}' #{[--pw-nt-hash ]ntlm} //#{RHOST}/#{dir} -c 'recurse;ls'
#@PWD.if_has(%%s)
#@ntlm.if_has(--pw-nt-hash %s)
@dir.desc(SMB Share Directory)

# List shared folders
# Null user
smbmap -H #{RHOST} #{smbmap_port}

# List shared folders
# Creds
smbmap -u "#{USER}" -p "#{PWD}" -H #{RHOST} #{smbmap_port} 

# List shared folders
# Pass-the-Hash
smbmap -u "#{USER}" -p "#{ntlm}" -H #{RHOST} #{smbmap_port} 

@smbmap_port.desc(SMB Port)
@smbmap_port.recommend(445 (SSH))
@smbmap_port.recommend(139)
@smbmap_port.if_has(-P %s)

@ntlm.desc(NTLM)